
var queryRecords;
var queryNotifications;

queryRecords = 'zzzz';
queryNotifications = 'name=(ACN) [EN] Survey User Invite^ORname=OCL:  Survey IT notification^ORname=(ACN) [PB] RITM BR0 Solicitacao fechada^ORname=(ACN) [PB] RITM BR0 Solicitacao resolvid^ORname=(ACN) [PB] R. Item resolved (ExtUsers)^ORname=2 (ACN) [EN] RITM CTR Resolved^ORname=(ACN) [PB] RITM CTR Resolved^ORname=(ACN) [PB] Survey User Invite^ORname=(ACN) [EN] RITM CTR Resolved^ORname=(ACN) [EN] REQUEST PROCESSED';

// Disable notifications
var gr = new GlideRecord('sysevent_email_action');
gr.addQuery(queryNotifications);
gr.query();
while(gr.next())
{
    gr.active = false;
    gr.update();
}

// Set records to resolved
var gr2 = new GlideRecord('sc_req_item');
gr2.addQuery(queryRecords);
gr2.query();
while(gr2.next())
{
    gr2.state = 99;
    gr2.update();
}

// Set records to closed completed and add comments
var gr3 = new GlideRecord('sc_req_item');
gr3.addQuery(queryRecords);
gr3.query();
while(gr3.next())
{
	gr3.state = 3;
	gr3.stage = 'closed_complete';
	gr3.comments = 'The request has been automatically marked as Completed.';
	gr3.update();
}

// Enable notifications
var gr4 = new GlideRecord('sysevent_email_action');
gr4.addQuery(queryNotifications);
gr4.query();
while(gr4.next())
{
    gr4.active = true;
    gr4.update();
}
