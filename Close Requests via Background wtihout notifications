
var queryRecords;
var queryNotifications;
var gr;

queryRecords = 'requested_for=8afe4db9db91b890ee41454039961916';
queryNotifications = 'name=(ACN) [EN] Survey User Invite^ORname=OCL:  Survey IT notification^ORname=(ACN) [PB] RITM BR0 Solicitacao fechada^ORname=(ACN) [PB] RITM BR0 Solicitacao resolvid^ORname=(ACN) [PB] R. Item resolved (ExtUsers)';

// Disable notifications
gr = new GlideRecord('sysevent_email_action');
gr.addQuery(queryNotifications);
gr.query();
while(gr.next())
{
    gr.active = false;
    gr.update();
}

// Set records to resolved
gr = new GlideRecord('sc_req_item');
gr.addQuery(queryRecords);
gr.query();
while(gr.next())
{
    gr.state = 99;
    gr.update();
}

// Set records to closed completed and add comments
var gr2 = new GlideRecord('sc_req_item');
gr2.addQuery(queryRecords);
gr2.query();
while(gr2.next())
{
	gr2.state = 3;
	gr2.stage = 'closed_complete';
	gr2.comments = 'The request has been automatically marked as Completed.';
	gr2.update();
}

// Enable notifications
gr = new GlideRecord('sysevent_email_action');
gr.addQuery(queryNotifications);
gr.query();
while(gr.next())
{
    gr.active = true;
    gr.update();
}
